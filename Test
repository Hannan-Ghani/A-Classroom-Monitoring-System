import org.apache.spark.sql.functions._
import org.apache.spark.sql.SparkSession

object CheckJsonFile {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession.builder().appName("Check JSON File").getOrCreate()

    // Replace with your actual JSON config path
    val configPath = "s3://your-bucket/config/rules.json"

    // Load the JSON config file
    val configDF = spark.read.json(configPath)

    // Print the schema of the JSON file to inspect structure
    println("Config JSON Schema:")
    configDF.printSchema()

    // Show the content of the JSON file to check for malformed entries
    println("Config JSON Data:")
    configDF.show(false)

    // Optionally filter out and display corrupt records (if any)
    val corruptRecords = configDF.filter(col("_corrupt_record").isNotNull)
    if (corruptRecords.count() > 0) {
      println("Warning: Found corrupt records in the config file!")
      corruptRecords.show(false)
    }
  }
}