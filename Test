// Helper function to filter out missing column pairs for comparison
def filterExistingColumnPairs(sourceColumns: Seq[String], targetColumns: Seq[String], sourceDF: DataFrame, targetDF: DataFrame): (Seq[String], Seq[String]) = {
  val existingSourceColumns = sourceDF.columns.toSet
  val existingTargetColumns = targetDF.columns.toSet
  var filteredSourceColumns: Seq[String] = Seq()
  var filteredTargetColumns: Seq[String] = Seq()

  for ((sourceCol, targetCol) <- sourceColumns.zip(targetColumns)) {
    if (existingSourceColumns.contains(sourceCol) && existingTargetColumns.contains(targetCol)) {
      filteredSourceColumns = filteredSourceColumns :+ sourceCol
      filteredTargetColumns = filteredTargetColumns :+ targetCol
    } else {
      logger.warn(s"Skipping comparison for columns: $sourceCol and $targetCol because one or both are missing.")
    }
  }
  (filteredSourceColumns, filteredTargetColumns)
}