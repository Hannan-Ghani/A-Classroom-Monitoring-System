// Select columns with aliases for alignment
val sourceSelected = transactionSource.select(col(sourceTransactionId).as("col_0") +: sourceColumns.tail.zipWithIndex.map {
  case (colName, i) => col(colName).as(s"col_${i + 1}")
}: _*)

val targetSelected = caseClass.select(col(targetTransactionId).as("col_0") +: targetColumns.tail.zipWithIndex.map {
  case (colName, i) => col(colName).as(s"col_${i + 1}")
}: _*)