def parseConfigFile(configPath: String, sparkSession: SparkSession): Map[String, String] = {
  import sparkSession.implicits._
  sparkSession.read.text(configPath).as[String].collect().flatMap { line =>
    val parts = line.split("=")
    if (parts.length == 2) {
      Some(parts(0).trim -> parts(1).trim)
    } else {
      // Log or handle invalid lines that do not contain "="
      println(s"Warning: Invalid config line - $line")
      None
    }
  }.toMap
}