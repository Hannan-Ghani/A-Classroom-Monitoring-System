#!/bin/bash

# Set the Glue job name
GLUE_JOB_NAME="gluejobforetl"

# Log the start of the job
echo "Starting AWS Glue job: $GLUE_JOB_NAME"

# Start the Glue job using AWS CLI in the specified region (eu-west-1)
response=$(aws glue start-job-run --job-name "$GLUE_JOB_NAME" --region eu-west-1)

# Capture the exit status of the AWS CLI command
STATUS=$?

# Check if the Glue job was started successfully
if [ $STATUS -eq 0 ]; then
    # Extract JobRunId from the response using jq (ensure jq is installed)
    JOB_RUN_ID=$(echo $response | jq -r '.JobRunId')
    echo "Glue job started successfully. JobRunId: $JOB_RUN_ID"
    exit 0
else
    echo "Failed to start Glue job: $GLUE_JOB_NAME"
    echo "Response: $response"
    exit $STATUS
fi